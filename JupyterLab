import torch
from torchvision import datasets, transforms
import matplotlib.pyplot as plt
import random

# Tải dữ liệu STL-10
stl10 = datasets.STL10(
    root='./data',
    download=True,
    transform=transforms.Compose([
        transforms.RandomVerticalFlip(),
        transforms.ToTensor(),
    ])
)

# Lấy số lượng mẫu trong tập dữ liệu STL-10
num_samples = len(stl10)

# Chọn ngẫu nhiên 10 mẫu dữ liệu (hoặc ít hơn nếu tập dữ liệu có ít hơn 10 mẫu)
random_indices = random.sample(range(num_samples), min(10, num_samples))

# Hiển thị ảnh tương ứng với các chỉ số ngẫu nhiên đã chọn
for i, idx in enumerate(random_indices):
    image, label = stl10[idx]

    # Chuyển tensor image về numpy array và hiển thị hình ảnh
    plt.subplot(2, 5, i + 1)
    plt.imshow(image.permute(1, 2, 0))
    plt.title(f"Sample {i + 1}")
    plt.axis('off')

plt.show()
